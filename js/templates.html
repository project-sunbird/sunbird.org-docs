<!-- Templates-->
<script id="template-widgetOldVersions" type="text/x-handlebars-template">
	<h2 id="olderVersionsHeading">Older Versions</h2>
	<ul id="olderVersions">
	{{#each versions}}
		{{#unless this.latest}}
		{{#if this.published}}
			<li>
				<a href="/{{this.title}}/" >{{this.title}}</a>
			</li>
		{{/if}}	
		{{/unless}}
	{{/each}}
	</ul>
</script>
<script id="template-widgetVersionSwitcher" type="text/x-handlebars-template">
	<select>
	{{#each versions}}
		<option value="{{this.title}}" >
			{{this.title}} {{#if this.latest}}(Latest){{/if}}
		</option>
	{{/each}}
	</select>
</script>
<script id="template-widgetLatestVersionNotification" type="text/x-handlebars-template">
	<div class="VersionNotification">
		Careful! You are browsing documentation for an older version of Sunbird. Go <a href="/latest/">here</a> to browse the documentation for the latest version
	</div>
</script>
<!-- /Templates-->

<script>
$(function () {
	// Old versions on main TOC
	var widgetOldVersionsContainer = $("#template-widgetOldVersions").html();
	var widgetOldVersionsTemplate = Handlebars.compile(widgetOldVersionsContainer);
	var widgetOldVersionsTemplateHtml = widgetOldVersionsTemplate(widgetsData);
	$('#widgetOldVersions').html(widgetOldVersionsTemplateHtml);
	
	// Widget Switcher
	var widgetVersionSwitcherContainer = $("#template-widgetVersionSwitcher").html();
	var widgetVersionSwitcherTemplate = Handlebars.compile(widgetVersionSwitcherContainer);
	var widgetVersionSwitcherTemplateHtml = widgetVersionSwitcherTemplate(widgetsData);
	$('#widgetVersionSwitcher').html(widgetVersionSwitcherTemplateHtml);
	
	// Latest Version notification
	var widgetLatestVersionNotificationContainer = $("#template-widgetLatestVersionNotification").html();
	var widgetLatestVersionNotificationTemplate = Handlebars.compile(widgetLatestVersionNotificationContainer);
	var widgetLatestVersionNotificationTemplateHtml = widgetLatestVersionNotificationTemplate(widgetsData);
	$('.widgetLatestVersionNotification').html(widgetLatestVersionNotificationTemplateHtml);
	
});
</script>
<script>
$(".js-latestVersion-title").text(latestVersion[0].title);
$(".js-latestVersion-releaseDate").text(latestVersion[0].releaseDate);

currentVersion = $('#docsVersion').attr("content");
$(".js-thisVersion-title").text(currentVersion);
$(".js-version-releaseDate").text(currentVersionData(currentVersion));
console.log(currentVersionData(currentVersion));

currentUrl = window.location.pathname;
$('#widgetVersionSwitcher select').val(currentVersion);
$('#widgetVersionSwitcher select').on('change', function () {
	switchVersion = $(this).val();
	updatedUrl = currentUrl.replace('latest',switchVersion);
	updatedUrl = updatedUrl.replace(currentVersion,switchVersion);
	window.location = updatedUrl; 
});
if (currentVersion == latestVersion[0].title){
	$('.widgetLatestVersionNotification').remove();
};
olderVersionsCount = $('ul#olderVersions li').length;
if (olderVersionsCount<1){
	$('#olderVersionsHeading').hide();
}
</script>
