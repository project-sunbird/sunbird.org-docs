<!DOCTYPE html>
<html>
	<head>
	<base id="baseURL" href="/4.9.0/" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=10, user-scalable=yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-touch-fullscreen" content="yes" />
<link rel="icon" type="image/png" href="/img/favicon/favicon-16x16.png" sizes="16x16">
<meta name="msapplication-TileColor" content="#65d3f7">
<meta name="msapplication-TileImage" content="/img/favicon/mstile-150x150.png">

<title>Generating API key</title>
<meta name="description" content="Generating API key for consumer on own Sunbird server installation"/>

<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="pragma" content="no-cache" />
<meta name="last-modified" content="2022-06-09 11:41:11 +0530">
<meta http-equiv="Expires" content="600" />

<!--Build Details-->
<meta name="buildVersion" content="" />
<meta name="buildNo" content="4240" />
<meta name="version" id="docsVersion" content="4.9.0" />
<!--/Build Details-->


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700" >
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" >
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?09062022"  />

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js?09062022"></script>
<script type="text/javascript" src="/js/jquery.tocLight.js?09062022"></script>
<script type="text/javascript" src="/js/jquery.elevateZoom-3.0.8.min.js?09062022"></script>
<script type="text/javascript" src="/js/handlebars-v4.0.11.js?09062022"></script>
<script type="text/javascript" src="/js/widgets-data.js?09062022"></script>
<script type="text/javascript" src="/js/widgets.js?09062022"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106552125-1"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-106552125-1');
</script>
<script>
function resetBase(){
	currentURLArray = window.location.pathname.split( '/' );
    secondLevelLocation = currentURLArray[1];
    if (secondLevelLocation == 'latest'){
		baseURL = document.getElementById('baseURL');
		baseURL.href="/latest/";
	}
}
resetBase();
</script>

	
		<meta name="robots" content="index, follow">
	
  </head>
  <body id="body" class="doc-layout">
  <div class="container inner container-height docs">
    <header class="logo-container">
      <div class="logo">
        <a href="https://www.sunbird.org" target="_blank">
          <img src="/img/sunbird-logo.png" alt="Sunbird" title="Sunbird">
        </a>
      </div>
      <button type="button" class="dropdown-toggle collapsed" id="dropdown-trigger" data-toggle="collapse" data-target="#mobile-dropdown" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </header>
    <nav class="sidebar-container" id="mobile-dropdown">
      <div class="inner__sidebar">
        

<div id="" class="sidebar-cover">
	
	 <div class="search-cover">
	<form method="get" action="https://www.google.com/search" target="_blank">
		<input type="text" value="" name="q" placeholder="Search"/ class="search-input" title="Enter keyword to search">
		<input type="hidden" value="en" name="hl" />
		<input type="hidden" name="sitesearch" value="http://docs.sunbird.org" />
		<input type="hidden" value="lang_en" name="lr" />
		<button type="submit" onclick="submit()" class="search-btn" title="Search">
			<i class="fa fa-search"></i>
		</button>
	</form>
</div>
 
	<div id="widgetVersionSwitcher"></div>
	
	<div class="sidebar-wrapper developer-docs"> 
		
			
				
				
				<div class="active">
					<a href="developer-docs/" >
						<h4 class="sidebar-group-title">Developer Documentation</h4>
					</a>
					
					<ul class="sidebar-group">
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/server-installation/" 
										 
										class="" 
										> 
										Server Installation
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/server-installation/prerequisites/" 
												
												class="" 
												>
												Pre-Requisites
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/server-installation/load-balancer-setup/" 
												
												class="" 
												>
												Optional Load Balancer Setup
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/server-installation/ansible-variables/" 
												
												class="" 
												>
												Ansible Variables
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/server-installation/jenkins-setup/" 
												
												class="" 
												>
												Jenkins Setup
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/server-installation/build-and-deploy/" 
												
												class="" 
												>
												Build and Deploy
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								
								<a 
									href="developer-docs/upgrade/" 
									
									class="" 
									>
									Upgrading Sunbird
								</a>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/application-configurations/" 
										 
										class="" 
										> 
										Application Configurations
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/env_variables_portal/" 
												
												class="" 
												>
												Portal Service Environment Variables
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/env_variables_content_service/" 
												
												class="" 
												>
												Content Service Environment Variables
											</a>
											<ul class="sidebar-group">
												
													<li>
														
														<a  
															href="developer-docs/application-configurations/configuring_domain_ext_links/" 
															
															class="" 
															>
															Import External Content
														</a>
													</li>
												
													<li>
														
														<a  
															href="developer-docs/application-configurations/content_filtering/" 
															
															class="" 
															>
															Content Filtering
														</a>
													</li>
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/system_settings/" 
												
												class="" 
												>
												System Settings
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/configuring_email_notification/" 
												
												class="" 
												>
												Email Notification Configuration
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/content_checklist_configuration/" 
												
												class="" 
												>
												Reviewer Checklist
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/metadata_driven_forms/" 
												
												class="" 
												>
												Metaforms Configuration
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/application-configurations/env_variables_lms/" 
												
												class="" 
												>
												LMS Service Environment Variables
											</a>
											<ul class="sidebar-group">
												
													<li>
														
														<a  
															href="developer-docs/application-configurations/sso_otpsms/" 
															
															class="" 
															>
															OTP based SMS Configuration
														</a>
													</li>
												
													<li>
														
														<a  
															href="developer-docs/application-configurations/keycloak_admin_config_settings/" 
															
															class="" 
															>
															Keycloak Admin Configuration
														</a>
													</li>
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/developer-installation/" 
										 
										class="" 
										> 
										Developer Installation
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/developer-installation/install_sbportal" 
												
												class="" 
												>
												Portal
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/mobile-app-installation/" 
										 
										class="" 
										> 
										Mobile App Installation
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/mobile-app-installation/mobile_app_forms" 
												
												class="" 
												>
												Mobile App forms
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/onboarding/" 
										 
										class="" 
										> 
										Onboarding
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/singlesignon/org_user_creation_sso/" 
												
												class="" 
												>
												Creating Organizations and Users
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/configuring_sunbird/configuring_announcement/" 
												
												class="" 
												>
												Creating Announcements
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/how-to-guide/overview_howto/" 
										 
										class="" 
										> 
										How-To-Guides
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_framework_in_sunbird/" 
												
												class="" 
												>
												Creating Framework
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_seeddata_in_framework/" 
												
												class="" 
												>
												Adding Content to Framework
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_organization/" 
												
												class="" 
												>
												Creating Organizations
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_user/" 
												
												class="" 
												>
												Creating Users
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_org_add_user/" 
												
												class="" 
												>
												Adding User to Organization
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_course_using_api/" 
												
												class="" 
												>
												Creating Course
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_upload_existing_content/" 
												
												class="" 
												>
												Uploading Content
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/how_to_create_badge/" 
												
												class="" 
												>
												Creating Badges
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/metadata_driven_forms" 
												
												class="" 
												>
												Configuring Metaforms
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/link_dial_code_to_a_book" 
												
												class="" 
												>
												Linking DIAL Code
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/how-to-guide/telemetry_data_consumption" 
												
												class="" 
												>
												Consuming Telemetry Data
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/telemetry/overview/" 
										 
										class="" 
										> 
										Telemetry
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/telemetry/specification/" 
												
												class="" 
												>
												Telemetry Specifications
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/telemetry/sending_telemetry/" 
												
												class="" 
												>
												Sending Telemetry
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/telemetry/consuming_telemetry/" 
												
												class="" 
												>
												Consuming Telemetry Data
											</a>
											<ul class="sidebar-group">
												
													<li>
														
														<a  
															href="developer-docs/telemetry/consuming_telemetry/#mobile-app-workflow" 
															
															class="" 
															>
															Mobile App Workflow
														</a>
													</li>
												
													<li>
														
														<a  
															href="developer-docs/telemetry/consuming_telemetry/#web-portal-workflow" 
															
															class="" 
															>
															Web Portal Workflow
														</a>
													</li>
												
													<li>
														
														<a  
															href="developer-docs/telemetry/consuming_telemetry/#content-editor-workflow" 
															
															class="" 
															>
															Content Editor Workflow
														</a>
													</li>
												
													<li>
														
														<a  
															href="developer-docs/telemetry/consuming_telemetry/#backend-services-workflow" 
															
															class="" 
															>
															Backend-services Workflow
														</a>
													</li>
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								<div class="">
									
									<a 
										href="developer-docs/library_reference/" 
										 
										class="" 
										> 
										Library References
									</a>
									<ul class="sidebar-group">
										
										<li>
											
											<a  
												href="developer-docs/telemetry/jslibrary/" 
												
												class="" 
												>
												Standalone JS Library
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/telemetry/htmlinterfacelibrary/" 
												
												class="" 
												>
												HTML Interface Library
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
										<li>
											
											<a  
												href="developer-docs/telemetry/authtokengenerator_jslibrary/" 
												
												class="" 
												>
												AuthToken Generator JS Library
											</a>
											<ul class="sidebar-group">
												
											</ul>
										</li>
										
									</ul>
								</div>
							
						</li>
					
						<li>
							
								
								<a 
									href="developer-docs/troubleshooting/" 
									
									class="" 
									>
									Troubleshooting
								</a>
							
						</li>
					
					</ul>
					
				</div>
			
				
				
				<div class="">
					<a href="apis/" >
						<h4 class="sidebar-group-title">API Reference Documentation</h4>
					</a>
					
					<ul class="sidebar-group">
					
						<li>
							
								
								<a 
									href="apis/#contribution--curation" 
									
									class="" 
									>
									Contribution & Curation
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#taxonomy--tagging" 
									
									class="" 
									>
									Taxonomy & Tagging
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#discovery--personalisation" 
									
									class="" 
									>
									Discovery & Personalization
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#interaction-and-collaboration" 
									
									class="" 
									>
									Interaction & Collaboration
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#learn-do-practice-sense--assess" 
									
									class="" 
									>
									Learn, Do, Practice, Sense & Assess
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#credentialing--badging" 
									
									class="" 
									>
									Credentialing & Badging
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#open-data" 
									
									class="" 
									>
									Open Data
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="apis/#learning-infra-telemetry--analytics" 
									
									class="" 
									>
									Learning Infra, Telemetry & Analytics
								</a>
							
						</li>
					
					</ul>
					
				</div>
			
				
				
				<div class="">
					<a href="faqs/" >
						<h4 class="sidebar-group-title">Frequently asked questions</h4>
					</a>
					
					<ul class="sidebar-group">
					
						<li>
							
								
								<a 
									href="faqs/audience/" 
									
									class="" 
									>
									Audience
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/content_format/" 
									
									class="" 
									>
									Content Format
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/content_repo/" 
									
									class="" 
									>
									Content Repositories
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/contentreviews/" 
									
									class="" 
									>
									Content Review
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/content_types/" 
									
									class="" 
									>
									Content Types
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/content_upload/" 
									
									class="" 
									>
									Content Upload
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/feature/" 
									
									class="" 
									>
									Features
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/fixerrors/" 
									
									class="" 
									>
									Fix Errors
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/helpsupport/" 
									
									class="" 
									>
									Help Support
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/intellectual_propertylicensesstandards/" 
									
									class="" 
									>
									Intellectual Property Licenses Standards
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/registrationenrolment/" 
									
									class="" 
									>
									Registration and Enrollment
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/signin/" 
									
									class="" 
									>
									Sign In
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/taxonomymetadataframework/" 
									
									class="" 
									>
									Taxonomy Metadata Framework
								</a>
							
						</li>
					
						<li>
							
								
								<a 
									href="faqs/user_rightspermissions/" 
									
									class="" 
									>
									Users Rights and Permission
								</a>
							
						</li>
					
					</ul>
					
				</div>
			
				
				
				<div class="">
					<a href="glossary/" >
						<h4 class="sidebar-group-title">Glossary</h4>
					</a>
					
				</div>
				
		
	</div>
</div>

<script>
	$("a[href$='developer-docs/how-to-guide/generate_apikey/']").addClass("sidebar-link-selected");
</script>

      </div>
    </nav>
    <div class="content">
      <div class="inner__content header" id="heading">
        <h1>Generating API key </h1>
      </div>

      <div id="main-content" class="inner__content">
			<p class="edit-para text-right">
				<span>
			<!--<a target="_blank" class="contribute" href="/contributions/contribution_guidelines/">
				  <i class="fa fa-book" aria-hidden="true"></i> <i>Contribution Guidelines</i>
			  </a> &nbsp;&nbsp;-->
			  
			 <a target="_blank"  title="Edit this page"class="" href="https://github.com/project-sunbird/sunbird.org-docs/edit/4.9.0/developer-docs/how-to-guide/generate_apikey.md">
				  <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit
			  </a> 
			  | 
			  <a target="_blank" href="https://github.com/project-sunbird/sunbird.org-docs/issues" title="Report issue">
				  <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
				  Report
			  </a>
			  </span>
			</p>
			<div class="widgetLatestVersionNotification"></div>
          <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
            <span class="toctoggle">[<a id="toctogglelink" class="internal" href="#">hide</a>]</span>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#scenario"><span class="tocnumber">1 .</span> <span class="toctext">Scenario</span></a>
            </li>
            <li class="toc_level-1 toc_section-2">
              <a href="#prerequisites"><span class="tocnumber">2 .</span> <span class="toctext">Prerequisites</span></a>
            </li>
            <li class="toc_level-1 toc_section-3">
              <a href="#generating-api-key"><span class="tocnumber">3 .</span> <span class="toctext">Generating API Key</span></a>
              <ul>
                <li class="toc_level-2 toc_section-4">
                  <a href="#create-consumer"><span class="tocnumber">3.1 .</span> <span class="toctext">Create Consumer</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-5">
              <a href="#generating-jwt"><span class="tocnumber">4 .</span> <span class="toctext">Generating JWT</span></a>
              <ul>
                <li class="toc_level-2 toc_section-6">
                  <a href="#adding-groups-to-consumers"><span class="tocnumber">4.1 .</span> <span class="toctext">Adding Groups to Consumers</span></a>
                </li>
                <li class="toc_level-2 toc_section-7">
                  <a href="#getting-consumer-details"><span class="tocnumber">4.2 .</span> <span class="toctext">Getting Consumer Details**</span></a>
                </li>
              </ul>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><h2 id="scenario">Scenario</h2>
<p>Let us consider an example of an organization, ABC Corp, which works in the domain of water conservation and works with multiple NGOs, village panchayats, and district administration authorities in multiple states of India. ABC Corp wants to use Sunbird to evangelize all the other entities they work with on irrigation technologies and water conservation technologies. To achieve this objective, ABC Corp must install Sunbird and enable all other entities involved to install Sunbird and use its features. For all the associated entities to install and use Sunbird, ABC Corp must generate and provide Sunbird API keys.</p>

<p>This document explains how an adopter, like ABC Corp, can generate Sunbird API keys from its own instance for their adopter XYZ Corp.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>For developer installation process the adopter use Ekstep servers</p>

<p>In server installation, different <a href="/developer-docs/server-installation/#infrastructure_components">servers</a> are required to install Sunbird.</p>

<blockquote>
  <p><strong>Note</strong>:</p>
  <ul>
    <li>
      <p>All the API operations should be triggered by docker swarm manager ( or any docker swarm client)</p>
    </li>
    <li>
      <p>Service admin_utils are not exposed to the public due to security concerns</p>
    </li>
  </ul>
</blockquote>

<h2 id="generating-api-key">Generating API Key</h2>
<p>Follow the steps as listed below to generate API keys</p>

<h3 id="create-consumer">Create Consumer</h3>

<p>Path for creating consumers: http://localhost:<strong>4000</strong>/v1/consumer/create</p>

<blockquote>
  <p><strong>Note</strong>: admin_utils is interacting with port 4000</p>
</blockquote>

<h4 id="request-body">Request Body</h4>

<ul>
  <li>
    <p>username= XYZ-Corp // Unique &amp; unmodifiable name of the consumer</p>

    <pre><code class="language-javascript">curl -X POST \
    http://localhost:4000/v1/consumer/create \
    -H 'Content-Type: application/json' \
    -d '{
    "id": "ekstep.api.am.adminutil.consumer.create",
    "ver": "1.0",
    "ets": 1489054878488,
    "params": {
      "msgid": ""
   }, 
   "request": {
      "username": "XYZ-Corp"
   }
}'
</code></pre>
  </li>
</ul>

<h4 id="response">Response</h4>

<pre>
  <code class="language-javascript">{
    "id":"ekstep.api.am.adminutil.consumer.create",
    "ver":"1.0",
    "ets":1542611334837,
    "params":{
        "status":"successful",
        "err":null,
        "errmsg":null,
        "msgid":"",
        "resmsgid":"c06ece80-d65f-4ac1-af80-8aeb05fa4881"
        },
    "result":{
        "key":"07dcc362679d477ea0711d74132203e1",
        "secret":"8ba62750a63648059839e782a0424b4f",
        "username":"XYZ-Corp"
        }
}
</code>
</pre>
<p>
  <strong>Error codes</strong>
</p>

<ul>
  <li>
    <p>INTERNAL_ERROR: Unknown/Unhandled error (equivalent HTTP 500)</p>
  </li>
  <li>
    <p>CONSUMER_GET_ERROR: Error when getting existing consumer</p>
  </li>
  <li>
    <p>GROUP_ASSIGN_ERROR: Error when assigning a consumer to the default group</p>
  </li>
  <li>
    <p>CREATE_CREDENTIAL_ERROR: Error when creating a credential</p>
  </li>
  <li>
    <p>BAD_REQUEST: Invalid request. Following are the reasons for this error</p>

    <ul>
      <li>
        <p>JSON is not parsable</p>
      </li>
      <li>
        <p>mandatory fields missing (username)</p>
      </li>
      <li>
        <p>username has space</p>
      </li>
      <li>
        <p>username is of type UUID (Due to Kong limitation, the username cannot be UUID)</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="generating-jwt">Generating JWT</h2>

<p>The key and secret issued in the above request can be used to create a JSON Web Token (JWT) for authorizing requests.</p>

<h4 id="request">Request</h4>

<p>The requests need to contain HS256 signed JSON Web Tokens (as specified in RFC 7519). Since we want to sign it using HS256, the JWT should be crafted according to RFC 7519:</p>

<p><strong>Header Parameters</strong>:</p>

<pre>
  <code class="language-javascript">{
        "typ": "JWT",
        "alg": "HS256"
}
</code>
</pre>

<h4 id="request-body-1">Request Body</h4>

<pre>
  <code class="language-javascript">{
        "iss": "8f00bc9585904d95e51cc4a1" \\ "key" of the credential  shared above.
}
</code>
</pre>

<p>The remaining fields of the JWT can be filled based on the details of the request being sent. For example, given below is the request body which accesses the content API:</p>

<pre>
  <code class="language-javascript">{
       "iss": "8f00bc9585904d95e51cc4a1", // the issuer of the claim or the "key"
       "iat": "1442426231600", // epoch timestamp when JWT was created
       "id": "org.sunbird.api.contentAPI", // target API
       "qsh": "8063ff4ca1e41df0f6207d491cf6dad7c66ea797b4614b7", // hashed query string
       "version": "1.0",  // version of the API
       "params": { // contextual parameters from the API request
          "did": "ff305d54-85b4-341b-da2f-eb6b9e5460fa", 
          "msgid": "c3049b36249a3c9f8891cb1999777743c"
       }
}
</code>
</pre>
<p>The generated JWT from the request:</p>

<pre>
  <code class="language-javascript">    eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhMzZjMzA0OWIzNjI0OWEzYzlmODg5MWNiMTI3MjQzYyIsImlhdCI6IjE0NDI0MjYyMzE2MDAiLCJpZCI6Im9yZy5la3N0ZXAuYXBpLmRhdGFTZXQiLCJxc2giOiI4MDYzZmY0Y2ExZTQxZGYwZjYyMDdkNDkxY2Y2ZGFkN2M2NmVhNzk3YjQ2MTRiNyIsInZlcnNpb24iOiIxLjAiLCJwYXJhbXMiOnsiZGlkIjoiZmYzMDVkNTQtODViNC0zNDFiLWRhMmYtZWI2YjllNTQ2MGZhIiwibXNnaWQiOiJjMzA0OWIzNjI0OWEzYzlmODg5MWNiMTk5OTc3Nzc0M2MifX0.rww4BN-EfnAXKTRltQChYA3KM31GzyEF-YpYvIBzw1I
</code>
</pre>

<p>Usually, the JWT will be created programmatically by your application. JWT libraries exist for all popular programming languages. However, you may also use the web-based tool - <a href="http://jwtbuilder.jamiekurtz.com/">jwtbuilder</a> to generate the JWT. Note that when using this tool, the <strong>key</strong> should be set as the <strong>iss</strong> field in the claims section of the payload and the <strong>secret</strong> obtained should be set as the <strong>Key</strong> field in the Signed JWT section. The Key will be used to generate a signed JWT.</p>

<h4 id="response-body">Response Body</h4>

<p>If auth fails, the response code will be 401 or 403 and will also have the error metadata in the response body. A normal response will be a 200. For clients which need to be protocol agnostic, the response body has error metadata to extract the error code and message, if any.</p>

<pre>
  <code class="language-javascript">{
        "id": "", // unique API ID
        "ver": "", // API version
        "ets": "", // epoch timestamp 
        "params": {
            "resmsgid": "", // unique response message id (UUID)
            "msgid": "", // message id of the request
            "status": "", // status of request e.g: successful, failed etc
            "err": "", // error code if any
            "errmsg": "" // default English error message
        },
        // API specific JSON output goes here
}
</code>
</pre>
<h3 id="adding-groups-to-consumers">Adding Groups to Consumers</h3>

<p>Each API have whitelisted acl groups. Consumers who have access to these groups access particular APIs.</p>

<p>For example, to read a content, consumer must have access to contentUser group.</p>

<p>API’s and groups attached to APIs are documented <a href="https://docs.google.com/spreadsheets/d/1O2QADGzizOClGRjmx_1JVGAHoXwDNY7GDsEtnO3nnpI/edit#gid=772094723">here</a>.</p>

<ul>
  <li>groups={list-of-group-names}</li>
</ul>

<h4 id="request-body-2">Request Body</h4>

<pre>
  <code class="language-javascript">curl -X POST \
      http://localhost:4000/v1/consumer/XYZ-Corp/grant \
      -H 'Content-Type: application/json' \
      -d '{
      "id": "ekstep.api.am.adminutil.consumer.grant",
      "ver": "1.0",
      "ets": 1489054878488,
      "params": {
        "msgid": ""
     }, 
     "request": {
        "groups": ["contentUser", "contentAdmin"]
     }
}'
</code>
</pre>
<h4 id="response-body-1">Response Body</h4>

<pre>
  <code class="language-javascript">{
    "id":"ekstep.api.am.adminutil.consumer.grant",
    "ver":"1.0",
    "ets":1542611633960,
    "params":{
        "status":"successful",
        "err":null,
        "errmsg":null,
        "msgid":"",
        "resmsgid":"5ac68867-502d-4e8b-bbc1-2c77fdc5a458"
    },
    "result":{
        "username":"XYZ-Corp",
        "groups":[
            "contentUser",
            "contentAdmin"
        ]
    }
}
</code>
</pre>

<h3 id="getting-consumer-details">Getting Consumer Details**</h3>

<h4 id="request-body-3">Request Body</h4>

<pre>
  <code class="language-javascript">curl -X POST \
      http://localhost:4000/v1/consumer/XYZ-Corp/read \
      -H 'Content-Type: application/json' \
      -d '{
      "id": "ekstep.api.am.adminutil.consumer.read",
      "ver": "1.0",
      "ets": 1489054878488,
      "params": {
        "msgid": ""
     }
}'
</code>
</pre>

<h4 id="response-body-2">Response Body</h4>
<pre>
  <code class="language-javascript">{
        "id": "ekstep.api.am.adminutil.consumer.read",
        "ver": "1.0",
        "ets": 1542609723572,
        "params": {
            "status": "successful",
            "err": null,
            "errmsg": null,
            "msgid": "",
            "resmsgid": "a1adcb76-cc02-46fb-8fcc-3737acf569de"
        },
        "result": {
            "username": "XYZ-Corp",
            "groups": [
                "contentUser",
                "contentAdmin"
            ]
        }
}
</code>
</pre>

          
          <hr />
          
          <p class="edit-para text-right">
			<a target="_blank" href="https://github.com/project-sunbird/sunbird.org-docs/edit/4.9.0/developer-docs/how-to-guide/generate_apikey.md" title="Fix this page">
				<i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit</a> |
			<a target="_blank" href="https://github.com/project-sunbird/sunbird.org-docs/issues" title="Report issue">
				<i class="fa fa-exclamation-circle" aria-hidden="true"></i> Report</a>
		  </p>
		  <a href="developer-docs/how-to-guide/generate_apikey/#heading" class="scrollup"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a>
          
      </div>
    </div>
    <div class="page-footer">
		<footer class="footer">
	<div class="footer__top">
		<div class="container">
			<div class="row">
				
			<div class="col-md-4 col-sm-12">
			</div>
			
			<div class="col-md-2 col-sm-6 ">
				<ul>
					<li><a href="http://www.sunbird.org/about/" target="_blank">About Sunbird</a></li>
					<li><a href="http://www.sunbird.org/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div>
			
			<div class="col-md-2 col-sm-6 sideline">
				<ul>
					<li><a href="http://www.sunbird.org/privacy-policy/" target="_blank">Privacy Policy</a></li>
					<li><a href="http://www.sunbird.org/features/" target="_blank">Microservices</a></li>
				</ul>
			</div>

			<div class="col-md-2 col-sm-12">
			</div>
			
		</div>
	</div>
</footer>
 

	</div>
  </div>
  <script type="text/javascript">
	//TOC Toggle
    $(function() {
        $.toc.clickHideButton();
    });
    //Scroll to top
    $(document).ready(function () {
		$(".content").scroll(function () {
			if ($(this).scrollTop() > 250) {
				$('.scrollup').fadeIn();
			} else {
				$('.scrollup').fadeOut();
			}
		});
	});
	$('#toc a').each(function(){
		var url = this.href.replace(baseURL.href, "");
		this.href = 'developer-docs/how-to-guide/generate_apikey/' + url;
    })
	$(".zoomcover").click(function(){
		if (!$(this).hasClass("fullscreen")){
			$(this).addClass("fullscreen");
			$(this).find(".zoom").addClass("enabled").elevateZoom({
				zoomType: "inner",
				cursor  : "crosshair",
				scrollZoom: "true"
			});
		} else {
			$(this).removeClass("fullscreen");
			$(this).find(".zoom").removeClass("enabled");
			$(".zoomContainer").hide();
		}
	});
	$(document).keyup(function(e) {
     if (e.keyCode == 27) { 
		$(".zoomcover").removeClass("fullscreen");
		$(".zoomcover").find(".zoom").removeClass("enabled");
		$(".zoomContainer").hide();
    }
});
  </script>
  <style>
  .zoom:hover{
	cursor:url(/img/zoom.png),crosshair;
  }
  .zoomWindowContainer:hover div{
	cursor:url(/img/scroll.png),crosshair !important;
	height:15px;
	width:15px;
  }
  </style>
  <div id="templates"></div>
  </body>
</html>
